<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Join Team</title>
  <script src="/socket.io/socket.io.js"></script>
</head>
<body>
  <h1>Welcome to the Escape Room!</h1>
  <form id="teamForm">
    <input type="text" id="playerNameInput" placeholder="dit navn" required />
    <input type="text" id="teamIdInput" placeholder="team ID" required />
    <button type="submit">Join Team</button>
  </form>
</body>
<script>
  // Initialize the socket globally
  window.socket = io();

  // Listen for socketId event from the server
socket.on('socketId', (id) => {
  console.log('Received socketId from server:', id);
  sessionStorage.setItem('socketId', id); // Store the socketId in sessionStorage
});
  // Handle the form submit where player chooses a team
  document.getElementById('teamForm').addEventListener('submit', (e) => {
    e.preventDefault();

    // Get the player name and team ID from the input fields
    const playerName = document.getElementById('playerNameInput').value.trim();
    const teamId = document.getElementById('teamIdInput').value.trim();
    const playerId = sessionStorage.getItem('socketId'); // Retrieve playerId from sessionStorage
    console.log('Player ID:', playerId); // Log the playerId for debugging
    
    if (!playerName) {
      alert('Please enter name!');
      return;
    }
    if (!teamId) {
      alert('Please enter a team ID!');
      return;
    }

    // Send team ID, playerName, and playerId to the server
    socket.emit('joinTeam', { playerId, teamId, playerName, playerId });
  });

  // If the team is full, redirect to game.html
  //socket.on('teamReady', () => {
  //  window.location.href = '/game_temp.html';
  //});

  // Handle general errors
  socket.on('errorJoiningTeam', (error) => {
    alert('Error: ' + error.message);
  });

  // Listen for redirection events from the server
  socket.on('redirect', (data) => {
    window.location.href = data.url;
  });
</script>
</html>

